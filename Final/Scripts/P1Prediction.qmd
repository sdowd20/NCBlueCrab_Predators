---
title: "P1Prediction"
format: html
editor: visual
---

This script is used to run cross-validation for both GAMs and gJam for part 1 of the study (grouped prey item models).

The workflow is as follows: 1) Load in script with datasets and necessary functions 2) Run GAMs separately for each predator for model types 1-6) in part 1 of the study (see Fig. 2 in manuscript) with 5-fold cross-validation repeating 100 times. 3) Run gJam separately for each predator for model type 3-6) in part 1 of the study (Fig. 2) based on burn-in time found through P1P2_burnin.qmd. 4) Load in data from both GAM and gJam CV. 5) Compute pairwise comparisons. 6) Collect summary metrics. 

```{r}
source("~/Documents/GitHub/NCBlueCrab_Predators/Scripts/Load.SDM.Final.R")
```

#### GAM CV

```{r}
#Define model in parsnip 
gam_mod <- gen_additive_mod() %>%
set_engine(engine = 'mgcv', family= tw(link= "log")) %>% set_mode('regression')
```

##### Red drum

```{r}
#Define type of cross validation: 5-fold cross-validation repeated 100 times on the dataset 
folds <- vfold_cv(df_CPUE_length_wide_both, v= 5, strata= reddrumP915, repeats= 100)
```

```{r}
#Cross-validation for models 1-6) for red drum 
##Environment
reddrum_env_wf <- workflow() %>% add_variables(outcomes= reddrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest)) %>% add_model(gam_mod, formula= reddrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest)) %>% fit(data= df_CPUE_length_wide_both) 

reddrum_env_cv <- reddrum_env_wf %>% fit_resamples(folds)
reddrum_env_cv2 <- collect_metrics(reddrum_env_cv)
combined_df <- do.call(rbind, reddrum_env_cv)

##Blue crab
reddrum_bc_wf <- workflow() %>% add_variables(outcomes= reddrumP915, predictors= c(logsmallbluecrabP120)) %>% add_model(gam_mod, formula= reddrumP915 ~ s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 
reddrum_bc_cv <- reddrum_bc_wf %>% fit_resamples(folds)
reddrum_bc_cv2 <- collect_metrics(reddrum_bc_cv)
combined_df <- do.call(rbind, reddrum_bc_cv)

##Total forage 
reddrum_forage_wf <- workflow() %>% add_variables(outcomes= reddrumP915, predictors= c(logreddrumP915forageP915, logreddrumP915forageP120)) %>% add_model(gam_mod, formula= reddrumP915 ~ s(logreddrumP915forageP915) + s(logreddrumP915forageP120)) %>% fit(data= df_CPUE_length_wide_both) 

reddrum_forage_cv <- reddrum_forage_wf %>% fit_resamples(folds)
reddrum_forage_cv2 <- collect_metrics(reddrum_forage_cv)
combined_df <- do.call(rbind, reddrum_forage_cv)

#Environment + blue crab
reddrum_env_bc_wf <- workflow() %>% add_variables(outcomes= reddrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logsmallbluecrabP120)) %>% add_model(gam_mod, formula= reddrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

reddrum_env_bc_cv <- reddrum_env_bc_wf %>% fit_resamples(folds)
reddrum_env_bc_cv2 <- collect_metrics(reddrum_env_bc_cv)
combined_df <- do.call(rbind, reddrum_env_bc_cv)
reddrum_env_bc_cv_unsumm <- collect_metrics(reddrum_env_bc_cv, summarize= FALSE)

##Environment + total forage
reddrum_env_forage_wf <- workflow() %>% add_variables(outcomes= reddrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logreddrumP915forageP915, logreddrumP915forageP120)) %>% add_model(gam_mod, formula= reddrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logreddrumP915forageP915) + s(logreddrumP915forageP120)) %>% fit(data= df_CPUE_length_wide_both) 

reddrum_env_forage_cv <- reddrum_env_forage_wf %>% fit_resamples(folds)
reddrum_env_forage_cv2 <- collect_metrics(reddrum_env_forage_cv)
combined_df <- do.call(rbind, reddrum_env_forage_cv)
reddrum_env_forage_cv_unsumm <- collect_metrics(reddrum_env_forage_cv, summarize= FALSE)

##Environment + blue crab + total forage 
reddrum_env_bc_forage_wf <- workflow() %>% add_variables(outcomes= reddrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logreddrumP915forageP915, logreddrumP915forageP120, logsmallbluecrabP120)) %>% add_model(gam_mod, formula= reddrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logreddrumP915forageP915) + s(logreddrumP915forageP120) + s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

reddrum_env_bc_forage_cv <- reddrum_env_bc_forage_wf %>% fit_resamples(folds)
reddrum_env_bc_forage_cv2 <- collect_metrics(reddrum_env_bc_forage_cv)
combined_df <- do.call(rbind, reddrum_env_bc_forage_cv)
reddrum_env_bc_forage_cv_unsumm <- collect_metrics(reddrum_env_bc_forage_cv, summarize= FALSE)
```

##### Southern kingfish

```{r}
folds <- vfold_cv(df_CPUE_length_wide_both, v= 5, strata= southernkingfishP915, repeats= 100)
```

```{r}
#Cross-validation for models 1-6) for southern kingfish
##Environment
southernkingfish_env_wf <- workflow() %>% add_variables(outcomes= southernkingfishP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest)) %>% add_model(gam_mod, formula= southernkingfishP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest)) %>% fit(data= df_CPUE_length_wide_both) 
southernkingfish_env_cv <- southernkingfish_env_wf %>% fit_resamples(folds)
southernkingfish_env_cv2 <- collect_metrics(southernkingfish_env_cv)
combined_df <- do.call(rbind, southernkingfish_env_cv)

#Blue crab
southernkingfish_bc_wf <- workflow() %>% add_variables(outcomes= southernkingfishP915, predictors= c(logsmallbluecrabP120)) %>% add_model(gam_mod, formula= southernkingfishP915 ~ s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

southernkingfish_bc_cv <- southernkingfish_bc_wf %>% fit_resamples(folds)
southernkingfish_bc_cv2 <- collect_metrics(southernkingfish_bc_cv)
combined_df <- do.call(rbind, southernkingfish_bc_cv)

#Total forage
southernkingfish_forage_wf <- workflow() %>% add_variables(outcomes= southernkingfishP915, predictors= c(logsouthernkingfishP915forageP915, logsouthernkingfishP915forageP120)) %>% add_model(gam_mod, formula= southernkingfishP915 ~ s(logsouthernkingfishP915forageP915) + s(logsouthernkingfishP915forageP120)) %>% fit(data= df_CPUE_length_wide_both) 

southernkingfish_forage_cv <- southernkingfish_forage_wf %>% fit_resamples(folds)
southernkingfish_forage_cv2 <- collect_metrics(southernkingfish_forage_cv)
combined_df <- do.call(rbind, southernkingfish_forage_cv)

##Environment + blue crab
southernkingfish_env_bc_wf <- workflow() %>% add_variables(outcomes= southernkingfishP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logsmallbluecrabP120)) %>% add_model(gam_mod, formula= southernkingfishP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

southernkingfish_env_bc_cv <- southernkingfish_env_bc_wf %>% fit_resamples(folds)
southernkingfish_env_bc_cv2 <- collect_metrics(southernkingfish_env_bc_cv)
combined_df <- do.call(rbind, southernkingfish_env_bc_cv)
southernkingfish_env_bc_cv_unsumm <- collect_metrics(southernkingfish_env_bc_cv, summarize= FALSE)

##Environment + total forage
southernkingfish_env_forage_wf <- workflow() %>% add_variables(outcomes= southernkingfishP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logsouthernkingfishP915forageP915, logsouthernkingfishP915forageP120)) %>% add_model(gam_mod, formula= southernkingfishP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logsouthernkingfishP915forageP915) + s(logsouthernkingfishP915forageP120)) %>% fit(data= df_CPUE_length_wide_both) 

southernkingfish_env_forage_cv <- southernkingfish_env_forage_wf %>% fit_resamples(folds)
southernkingfish_env_forage_cv2 <- collect_metrics(southernkingfish_env_forage_cv)
combined_df <- do.call(rbind, southernkingfish_env_forage_cv)
southernkingfish_env_forage_cv_unsumm <- collect_metrics(southernkingfish_env_forage_cv, summarize= FALSE)

##Environment + blue crab + total forage 
southernkingfish_env_bc_forage_wf <- workflow() %>% add_variables(outcomes= southernkingfishP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logsouthernkingfishP915forageP915, logsouthernkingfishP915forageP120, logsmallbluecrabP120)) %>% add_model(gam_mod, formula= southernkingfishP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logsouthernkingfishP915forageP915) + s(logsouthernkingfishP915forageP120) + s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

southernkingfish_env_bc_forage_cv <- southernkingfish_env_bc_forage_wf %>% fit_resamples(folds)
southernkingfish_env_bc_forage_cv2 <- collect_metrics(southernkingfish_env_bc_forage_cv)
combined_df <- do.call(rbind, southernkingfish_env_bc_forage_cv)
southernkingfish_env_bc_forage_cv_unsumm <- collect_metrics(southernkingfish_env_bc_forage_cv, summarize= FALSE)
```

##### Black drum

```{r}
folds <- vfold_cv(df_CPUE_length_wide_both, v= 5, strata= blackdrumP915, repeats= 100)
```

```{r}
#Cross-validation for models 1-6) for black drum
##Environment
blackdrum_env_wf <- workflow() %>% add_variables(outcomes= blackdrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest)) %>% add_model(gam_mod, formula= blackdrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest)) %>% fit(data= df_CPUE_length_wide_both) 
blackdrum_env_cv <- blackdrum_env_wf %>% fit_resamples(folds)
blackdrum_env_cv2 <- collect_metrics(blackdrum_env_cv)
combined_df <- do.call(rbind, blackdrum_env_cv)

#Blue crab
blackdrum_bc_wf <- workflow() %>% add_variables(outcomes= blackdrumP915, predictors= c(logsmallbluecrabP120)) %>% add_model(gam_mod, formula= blackdrumP915 ~ s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

blackdrum_bc_cv <- blackdrum_bc_wf %>% fit_resamples(folds)
blackdrum_bc_cv2 <- collect_metrics(blackdrum_bc_cv)
combined_df <- do.call(rbind, blackdrum_bc_cv)

#Total forage
blackdrum_forage_wf <- workflow() %>% add_variables(outcomes= blackdrumP915, predictors= c(logblackdrumP915forageP120)) %>% add_model(gam_mod, formula= blackdrumP915 ~ s(logblackdrumP915forageP120)) %>% fit(data= df_CPUE_length_wide_both) 

blackdrum_forage_cv <- blackdrum_forage_wf %>% fit_resamples(folds)
blackdrum_forage_cv2 <- collect_metrics(blackdrum_forage_cv)
combined_df <- do.call(rbind, blackdrum_forage_cv)

#Environment + blue crab
blackdrum_env_bc_wf <- workflow() %>% add_variables(outcomes= blackdrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logsmallbluecrabP120)) %>% add_model(gam_mod, formula= blackdrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

blackdrum_env_bc_cv <- blackdrum_env_bc_wf %>% fit_resamples(folds)
blackdrum_env_bc_cv2 <- collect_metrics(blackdrum_env_bc_cv)
combined_df <- do.call(rbind, blackdrum_env_bc_cv)
blackdrum_env_bc_cv_unsumm <- collect_metrics(blackdrum_env_bc_cv, summarize= FALSE)

##Environment + total forage
blackdrum_env_forage_wf <- workflow() %>% add_variables(outcomes= blackdrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logblackdrumP915forageP120)) %>% add_model(gam_mod, formula= blackdrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logblackdrumP915forageP120)) %>% fit(data= df_CPUE_length_wide_both) 

blackdrum_env_forage_cv <- blackdrum_env_forage_wf %>% fit_resamples(folds)
blackdrum_env_forage_cv2 <- collect_metrics(blackdrum_env_forage_cv)
combined_df <- do.call(rbind, blackdrum_env_forage_cv)
blackdrum_env_forage_cv_unsumm <- collect_metrics(blackdrum_env_forage_cv, summarize= FALSE)

##Environment + blue crab + total forage 
blackdrum_env_bc_forage_wf <- workflow() %>% add_variables(outcomes= blackdrumP915, predictors= c(avgdepth, avgssal, avgstemp, avgsdo, NoFishRest, logblackdrumP915forageP120, logsmallbluecrabP120)) %>% add_model(gam_mod, formula= blackdrumP915 ~ s(avgdepth) + s(avgssal) + s(avgstemp) + s(avgsdo) + s(NoFishRest) + s(logblackdrumP915forageP120) + s(logsmallbluecrabP120)) %>% fit(data= df_CPUE_length_wide_both) 

blackdrum_env_bc_forage_cv <- blackdrum_env_bc_forage_wf %>% fit_resamples(folds)
blackdrum_env_bc_forage_cv2 <- collect_metrics(blackdrum_env_bc_forage_cv)
combined_df <- do.call(rbind, blackdrum_env_bc_forage_cv)
blackdrum_env_bc_forage_cv_unsumm <- collect_metrics(blackdrum_env_bc_forage_cv, summarize= FALSE)
```

#### gJam CV

##### Red drum

###### Environment + blue crab
```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both))

reddrum_env_bc_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(reddrum_env_bc_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(reddrumP915, logsmallbluecrabP120) 
xdata_test <- test  
ydata_test <- test %>% dplyr::select(reddrumP915, logsmallbluecrabP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

#conditional prediction: ycondData holds columns to condition on, columns not included in ycondData will be predicted conditionally 
ycond <- ydata_test[,!colnames(ydata_test) %in% "reddrumP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_reddrum_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "reddrumP915"]
obs_reddrum <- ydata_test[,colnames(ydata_test) %in% "reddrumP915"] #observed reddrum

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_reddrum_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "reddrumP915"]
pred_reddrum_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "reddrumP915"]

dat <- cbind(pred_reddrum_con, obs_reddrum, pred_reddrum_un)
dat <- as.data.frame(dat)

reddrum_env_bc_gjam[i,1] <- r2_general(dat$pred_reddrum_con, dat$reddrumP915)
reddrum_env_bc_gjam[i,2] <- r2_general(dat$pred_reddrum_un, dat$reddrumP915)
reddrum_env_bc_gjam[i,3] <- RMSE_func(actual = dat$reddrumP915, pred = dat$pred_reddrum_con)
reddrum_env_bc_gjam[i,4] <- RMSE_func(actual = dat$reddrumP915, pred = dat$pred_reddrum_un) 
print(i)
}
```

###### Environment + forage
```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both)) #just determines sample size

reddrum_env_forage_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(reddrum_env_forage_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(reddrumP915, logreddrumP915forageP915, logreddrumP915forageP120) 
xdata_test <- test #only accepts all data! 
ydata_test <- test %>% dplyr::select(reddrumP915, logreddrumP915forageP915, logreddrumP915forageP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "reddrumP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_reddrum_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "reddrumP915"]
obs_reddrum <- ydata_test[,colnames(ydata_test) %in% "reddrumP915"] #observed reddrum

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_reddrum_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "reddrumP915"]
pred_reddrum_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "reddrumP915"]

dat <- cbind(pred_reddrum_con, obs_reddrum, pred_reddrum_un)
dat <- as.data.frame(dat)

reddrum_env_forage_gjam[i,1] <- r2_general(dat$pred_reddrum_con, dat$reddrumP915)
reddrum_env_forage_gjam[i,2] <- r2_general(dat$pred_reddrum_un, dat$reddrumP915)
reddrum_env_forage_gjam[i,3] <- RMSE_func(actual = dat$reddrumP915, pred = dat$pred_reddrum_con)
reddrum_env_forage_gjam[i,4] <- RMSE_func(actual = dat$reddrumP915, pred = dat$pred_reddrum_un) 
print(i)
}
```

###### Environment + blue crab + total forage
```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both)) #just determines sample size

reddrum_env_bc_forage_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(reddrum_env_bc_forage_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(reddrumP915, logreddrumP915forageP915, logreddrumP915forageP120, logsmallbluecrabP120) 
xdata_test <- test #only accepts all data! 
ydata_test <- test %>% dplyr::select(reddrumP915, logreddrumP915forageP915, logreddrumP915forageP120, logsmallbluecrabP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "reddrumP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_reddrum_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "reddrumP915"]
obs_reddrum <- ydata_test[,colnames(ydata_test) %in% "reddrumP915"] #observed reddrum

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_reddrum_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "reddrumP915"]
pred_reddrum_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "reddrumP915"]

dat <- cbind(pred_reddrum_con, obs_reddrum, pred_reddrum_un)
dat <- as.data.frame(dat)

reddrum_env_bc_forage_gjam[i,1] <- r2_general(dat$pred_reddrum_con, dat$reddrumP915)
reddrum_env_bc_forage_gjam[i,2] <- r2_general(dat$pred_reddrum_un, dat$reddrumP915)
reddrum_env_bc_forage_gjam[i,3] <- RMSE_func(actual = dat$reddrumP915, pred = dat$pred_reddrum_con)
reddrum_env_bc_forage_gjam[i,4] <- RMSE_func(actual = dat$reddrumP915, pred = dat$pred_reddrum_un) 
print(i)
}
```

##### Southern kingfish

###### Environment + blue crab

```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both))

southernkingfish_env_bc_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(southernkingfish_env_bc_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(southernkingfishP915, logsmallbluecrabP120) 
xdata_test <- test  
ydata_test <- test %>% dplyr::select(southernkingfishP915, logsmallbluecrabP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "southernkingfishP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_southernkingfish_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "southernkingfishP915"]
obs_southernkingfish <- ydata_test[,colnames(ydata_test) %in% "southernkingfishP915"] #observed southernkingfish

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_southernkingfish_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "southernkingfishP915"]
pred_southernkingfish_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "southernkingfishP915"]

dat <- cbind(pred_southernkingfish_con, obs_southernkingfish, pred_southernkingfish_un)
dat <- as.data.frame(dat)

southernkingfish_env_bc_gjam[i,1] <- r2_general(dat$pred_southernkingfish_con, dat$southernkingfishP915)
southernkingfish_env_bc_gjam[i,2] <- r2_general(dat$pred_southernkingfish_un, dat$southernkingfishP915)
southernkingfish_env_bc_gjam[i,3] <- RMSE_func(actual = dat$southernkingfishP915, pred = dat$pred_southernkingfish_con)
southernkingfish_env_bc_gjam[i,4] <- RMSE_func(actual = dat$southernkingfishP915, pred = dat$pred_southernkingfish_un) 
print(i)
}
```

###### Environment + total forage

```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both)) #just determines sample size

southernkingfish_env_forage_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(southernkingfish_env_forage_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(southernkingfishP915, logsouthernkingfishP915forageP915, logsouthernkingfishP915forageP120) 
xdata_test <- test #only accepts all data! 
ydata_test <- test %>% dplyr::select(southernkingfishP915, logsouthernkingfishP915forageP915, logsouthernkingfishP915forageP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "southernkingfishP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_southernkingfish_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "southernkingfishP915"]
obs_southernkingfish <- ydata_test[,colnames(ydata_test) %in% "southernkingfishP915"] #observed southernkingfish

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_southernkingfish_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "southernkingfishP915"]
pred_southernkingfish_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "southernkingfishP915"]

dat <- cbind(pred_southernkingfish_con, obs_southernkingfish, pred_southernkingfish_un)
dat <- as.data.frame(dat)

southernkingfish_env_forage_gjam[i,1] <- r2_general(dat$pred_southernkingfish_con, dat$southernkingfishP915)
southernkingfish_env_forage_gjam[i,2] <- r2_general(dat$pred_southernkingfish_un, dat$southernkingfishP915)
southernkingfish_env_forage_gjam[i,3] <- RMSE_func(actual = dat$southernkingfishP915, pred = dat$pred_southernkingfish_con)
southernkingfish_env_forage_gjam[i,4] <- RMSE_func(actual = dat$southernkingfishP915, pred = dat$pred_southernkingfish_un) 
print(i)
}
```

##### Environment + blue crab + total forage
```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both)) #just determines sample size

southernkingfish_env_bc_forage_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(southernkingfish_env_bc_forage_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(southernkingfishP915, logsouthernkingfishP915forageP915, logsouthernkingfishP915forageP120, logsmallbluecrabP120) 
xdata_test <- test #only accepts all data! 
ydata_test <- test %>% dplyr::select(southernkingfishP915, logsouthernkingfishP915forageP915, logsouthernkingfishP915forageP120, logsmallbluecrabP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "southernkingfishP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_southernkingfish_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "southernkingfishP915"]
obs_southernkingfish <- ydata_test[,colnames(ydata_test) %in% "southernkingfishP915"] #observed southernkingfish

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_southernkingfish_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "southernkingfishP915"]
pred_southernkingfish_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "southernkingfishP915"]

dat <- cbind(pred_southernkingfish_con, obs_southernkingfish, pred_southernkingfish_un)
dat <- as.data.frame(dat)

southernkingfish_env_bc_forage_gjam[i,1] <- r2_general(dat$pred_southernkingfish_con, dat$southernkingfishP915)
southernkingfish_env_bc_forage_gjam[i,2] <- r2_general(dat$pred_southernkingfish_un, dat$southernkingfishP915)
southernkingfish_env_bc_forage_gjam[i,3] <- RMSE_func(actual = dat$southernkingfishP915, pred = dat$pred_southernkingfish_con)
southernkingfish_env_bc_forage_gjam[i,4] <- RMSE_func(actual = dat$southernkingfishP915, pred = dat$pred_southernkingfish_un) 
print(i)
}
```

##### Black drum

###### Environment + BC

```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both))

blackdrum_env_bc_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(blackdrum_env_bc_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(blackdrumP915, logsmallbluecrabP120) 
xdata_test <- test  
ydata_test <- test %>% dplyr::select(blackdrumP915, logsmallbluecrabP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "blackdrumP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_blackdrum_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "blackdrumP915"]
obs_blackdrum <- ydata_test[,colnames(ydata_test) %in% "blackdrumP915"] #observed blackdrum

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_blackdrum_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "blackdrumP915"]
pred_blackdrum_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "blackdrumP915"]

dat <- cbind(pred_blackdrum_con, obs_blackdrum, pred_blackdrum_un)
dat <- as.data.frame(dat)

blackdrum_env_bc_gjam[i,1] <- r2_general(dat$pred_blackdrum_con, dat$blackdrumP915)
blackdrum_env_bc_gjam[i,2] <- r2_general(dat$pred_blackdrum_un, dat$blackdrumP915)
blackdrum_env_bc_gjam[i,3] <- RMSE_func(actual = dat$blackdrumP915, pred = dat$pred_blackdrum_con)
blackdrum_env_bc_gjam[i,4] <- RMSE_func(actual = dat$blackdrumP915, pred = dat$pred_blackdrum_un) 
print(i)
}
```

###### Environment + total forage
```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both)) #just determines sample size

blackdrum_env_forage_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(blackdrum_env_forage_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(blackdrumP915, logblackdrumP915forageP120) 
xdata_test <- test #only accepts all data! 
ydata_test <- test %>% dplyr::select(blackdrumP915, logblackdrumP915forageP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "blackdrumP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_blackdrum_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "blackdrumP915"]
obs_blackdrum <- ydata_test[,colnames(ydata_test) %in% "blackdrumP915"] #observed blackdrum

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_blackdrum_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "blackdrumP915"]
pred_blackdrum_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "blackdrumP915"]

dat <- cbind(pred_blackdrum_con, obs_blackdrum, pred_blackdrum_un)
dat <- as.data.frame(dat)

blackdrum_env_forage_gjam[i,1] <- r2_general(dat$pred_blackdrum_con, dat$blackdrumP915)
blackdrum_env_forage_gjam[i,2] <- r2_general(dat$pred_blackdrum_un, dat$blackdrumP915)
blackdrum_env_forage_gjam[i,3] <- RMSE_func(actual = dat$blackdrumP915, pred = dat$pred_blackdrum_con)
blackdrum_env_forage_gjam[i,4] <- RMSE_func(actual = dat$blackdrumP915, pred = dat$pred_blackdrum_un) 
print(i)
}
```

###### Environment + blue crab + total forage
```{r}
Bootstrap_times <- 100
smp_size <- floor(0.80* nrow(df_CPUE_length_wide_both)) #just determines sample size

blackdrum_env_bc_forage_gjam <- data.frame(matrix(ncol=4, nrow=1))
colnames(blackdrum_env_bc_forage_gjam) <- c("r2_con", "r2_uncon", "rmse_con", "rmse_uncon")

for(i in 1:Bootstrap_times){
train_ind <- sample(seq_len(nrow(df_CPUE_length_wide_both)), size = smp_size)
train <- df_CPUE_length_wide_both[train_ind, ]
test <- df_CPUE_length_wide_both[-train_ind, ]

xnames <- c("avgdepth", "avgstemp", "avgssal", "avgsdo", "NoFishRest")
xdata_train <- train[,colnames(train) %in% xnames]
ydata_train <- train %>% dplyr::select(blackdrumP915, logblackdrumP915forageP120, logsmallbluecrabP120) 
xdata_test <- test #only accepts all data! 
ydata_test <- test %>% dplyr::select(blackdrumP915, logblackdrumP915forageP120, logsmallbluecrabP120)

ml <- list(ng = 20000, burnin = 8000, typeNames = 'CA')

mod2 <- gjam(~ avgdepth + avgstemp + avgssal + avgsdo + NoFishRest, xdata = xdata_train, ydata = ydata_train, modelList = ml) #4/5 of data 

ycond <- ydata_test[,!colnames(ydata_test) %in% "blackdrumP915"]
newdata1 <- list(xdata = xdata_test, ydataCond = ycond, nsim = 1000) 
p6 <- gjamPredict(mod2, newdata= newdata1) #1/5 of data 
pred_blackdrum_con <- p6$sdList$yMu[,colnames(p6$sdList$yMu) %in% "blackdrumP915"]
obs_blackdrum <- ydata_test[,colnames(ydata_test) %in% "blackdrumP915"] #observed blackdrum

#unconditional prediction out of sample
newdata <- list(xdata = xdata_test, nsim = 1000)
p7 <- gjamPredict(mod2, newdata = newdata)
pred_blackdrum_un <- p7$sdList$yMu[,colnames(p7$sdList$yMu) %in% "blackdrumP915"]
pred_blackdrum_un2 <- mod2$prediction$ypredMu[,colnames(mod2$prediction$ypredMu) %in% "blackdrumP915"]

dat <- cbind(pred_blackdrum_con, obs_blackdrum, pred_blackdrum_un)
dat <- as.data.frame(dat)

blackdrum_env_bc_forage_gjam[i,1] <- r2_general(dat$pred_blackdrum_con, dat$blackdrumP915)
blackdrum_env_bc_forage_gjam[i,2] <- r2_general(dat$pred_blackdrum_un, dat$blackdrumP915)
blackdrum_env_bc_forage_gjam[i,3] <- RMSE_func(actual = dat$blackdrumP915, pred = dat$pred_blackdrum_con)
blackdrum_env_bc_forage_gjam[i,4] <- RMSE_func(actual = dat$blackdrumP915, pred = dat$pred_blackdrum_un) 
print(i)
}
```

#### Load-in data 
```{r}
### Red Drum ###
#Env_bc 
reddrum_gam_env_bc <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/reddrum_env_bc_cv_unsumm.csv")
reddrum_gam_env_bc <- reddrum_gam_env_bc %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
reddrum_gJam_env_bc <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/reddrum_env_bc.csv")

#Env_forage
reddrum_gam_env_forage <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/reddrum_env_forage_cv_unsumm.csv")
reddrum_gam_env_forage <- reddrum_gam_env_forage %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
reddrum_gJam_env_forage <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/reddrum_env_forage.csv")

#Env_bc_forage
reddrum_gam_env_bc_forage <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/reddrum_env_bc_forage_cv_unsumm.csv")
reddrum_gam_env_bc_forage <- reddrum_gam_env_bc_forage %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
reddrum_gJam_env_bc_forage <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/reddrum_env_bc_forage.csv")
```

```{r}
### Southern kingfish ###
#Env_bc 
southernkingfish_gam_env_bc <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/southernkingfish_env_bc_cv_unsumm.csv")
southernkingfish_gam_env_bc <- southernkingfish_gam_env_bc %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
southernkingfish_gJam_env_bc <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/southernkingfish_env_bc.csv")

#Env_forage
southernkingfish_gam_env_forage <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/southernkingfish_env_forage_cv_unsumm.csv")
southernkingfish_gam_env_forage <- southernkingfish_gam_env_forage %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
southernkingfish_gJam_env_forage <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/southernkingfish_env_forage.csv")

#Env_bc_forage
southernkingfish_gam_env_bc_forage <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/southernkingfish_env_bc_forage_cv_unsumm.csv")
southernkingfish_gam_env_bc_forage <- southernkingfish_gam_env_bc_forage %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
southernkingfish_gJam_env_bc_forage <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/southernkingfish_env_bc_forage.csv")
```

```{r}
### Black drum ###
#Env_bc 
blackdrum_gam_env_bc <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/blackdrum_env_bc_cv_unsumm.csv")
blackdrum_gam_env_bc <- blackdrum_gam_env_bc %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
blackdrum_gJam_env_bc <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/blackdrum_env_bc.csv")

#Env_forage
blackdrum_gam_env_forage <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/blackdrum_env_forage_cv_unsumm.csv")
blackdrum_gam_env_forage <- blackdrum_gam_env_forage %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
blackdrum_gJam_env_forage <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/blackdrum_env_forage.csv")

#Env_bc_forage
blackdrum_gam_env_bc_forage <- read.csv("/Users/sallydowd/Google Drive/My Drive/Research/Ch1Data/Final_results/GAMs/CV/Summary/blackdrum_env_bc_forage_cv_unsumm.csv")
blackdrum_gam_env_bc_forage <- blackdrum_gam_env_bc_forage %>% dplyr::select(-X) %>% pivot_wider(names_from= .metric, values_from= .estimate) %>% group_by(id) %>% summarize(mean_rsq= mean(rsq), mean_rmse= mean(rmse))
blackdrum_gJam_env_bc_forage <- read.csv("~/Google Drive/My Drive/Research/Ch1Data/Final_results/gJam/Prediction/blackdrum_env_bc_forage.csv")
```

#### Pairwise test
```{r}
### Red drum ###
#Env_bc 
wilcox.test(reddrum_gam_env_bc$mean_rsq, reddrum_gJam_env_bc$r2_uncon, paired = FALSE)
wilcox.test(reddrum_gam_env_bc$mean_rsq, reddrum_gJam_env_bc$r2_con, paired = FALSE) 
wilcox.test(reddrum_gJam_env_bc$r2_uncon, reddrum_gJam_env_bc$r2_con, paired = TRUE) 
wilcox.test(reddrum_gam_env_bc$mean_rmse, reddrum_gJam_env_bc$rmse_uncon, paired = FALSE)
wilcox.test(reddrum_gam_env_bc$mean_rmse, reddrum_gJam_env_bc$rmse_con, paired = FALSE) 
wilcox.test(reddrum_gJam_env_bc$rmse_uncon, reddrum_gJam_env_bc$rmse_con, paired = TRUE) 

#Env_forage
wilcox.test(reddrum_gam_env_forage$mean_rsq, reddrum_gJam_env_forage$r2_uncon, paired = FALSE)
wilcox.test(reddrum_gam_env_forage$mean_rsq, reddrum_gJam_env_forage$r2_con, paired = FALSE) 
wilcox.test(reddrum_gJam_env_forage$r2_uncon, reddrum_gJam_env_forage$r2_con, paired = TRUE) 
wilcox.test(reddrum_gam_env_forage$mean_rmse, reddrum_gJam_env_forage$rmse_uncon, paired = FALSE)
wilcox.test(reddrum_gam_env_forage$mean_rmse, reddrum_gJam_env_forage$rmse_con, paired = FALSE) 
wilcox.test(reddrum_gJam_env_forage$rmse_uncon, reddrum_gJam_env_forage$rmse_con, paired = TRUE) 

#Env_bc_forage
wilcox.test(reddrum_gam_env_bc_forage$mean_rsq, reddrum_gJam_env_bc_forage$r2_uncon, paired = FALSE)
wilcox.test(reddrum_gam_env_bc_forage$mean_rsq, reddrum_gJam_env_bc_forage$r2_con, paired = FALSE) 
wilcox.test(reddrum_gJam_env_bc_forage$r2_uncon, reddrum_gJam_env_bc_forage$r2_con, paired = TRUE) 
wilcox.test(reddrum_gam_env_bc_forage$mean_rmse, reddrum_gJam_env_bc_forage$rmse_uncon, paired = FALSE)
wilcox.test(reddrum_gam_env_bc_forage$mean_rmse, reddrum_gJam_env_bc_forage$rmse_con, paired = FALSE) 
wilcox.test(reddrum_gJam_env_bc_forage$rmse_uncon, reddrum_gJam_env_bc_forage$rmse_con, paired = TRUE) 
```

```{r}
### Southern kingfish ###
#Env_bc 
wilcox.test(southernkingfish_gam_env_bc$mean_rsq, southernkingfish_gJam_env_bc$r2_uncon, paired = FALSE)
wilcox.test(southernkingfish_gam_env_bc$mean_rsq, southernkingfish_gJam_env_bc$r2_con, paired = FALSE) 
wilcox.test(southernkingfish_gJam_env_bc$r2_uncon, southernkingfish_gJam_env_bc$r2_con, paired = TRUE) 
wilcox.test(southernkingfish_gam_env_bc$mean_rmse, southernkingfish_gJam_env_bc$rmse_uncon, paired = FALSE)
wilcox.test(southernkingfish_gam_env_bc$mean_rmse, southernkingfish_gJam_env_bc$rmse_con, paired = FALSE) 
wilcox.test(southernkingfish_gJam_env_bc$rmse_uncon, southernkingfish_gJam_env_bc$rmse_con, paired = TRUE) 

#Env_forage
wilcox.test(southernkingfish_gam_env_forage$mean_rsq, southernkingfish_gJam_env_forage$r2_uncon, paired = FALSE)
wilcox.test(southernkingfish_gam_env_forage$mean_rsq, southernkingfish_gJam_env_forage$r2_con, paired = FALSE)
wilcox.test(southernkingfish_gJam_env_forage$r2_uncon, southernkingfish_gJam_env_forage$r2_con, paired = TRUE) 
wilcox.test(southernkingfish_gam_env_forage$mean_rmse, southernkingfish_gJam_env_forage$rmse_uncon, paired = FALSE)
wilcox.test(southernkingfish_gam_env_forage$mean_rmse, southernkingfish_gJam_env_forage$rmse_con, paired = FALSE) 
wilcox.test(southernkingfish_gJam_env_forage$rmse_uncon, southernkingfish_gJam_env_forage$rmse_con, paired = TRUE) 

#Env_bc_forage
wilcox.test(southernkingfish_gam_env_bc_forage$mean_rsq, southernkingfish_gJam_env_bc_forage$r2_uncon, paired = FALSE)
wilcox.test(southernkingfish_gam_env_bc_forage$mean_rsq, southernkingfish_gJam_env_bc_forage$r2_con, paired = FALSE) 
wilcox.test(southernkingfish_gJam_env_bc_forage$r2_uncon, southernkingfish_gJam_env_bc_forage$r2_con, paired = TRUE) 
wilcox.test(southernkingfish_gam_env_bc_forage$mean_rmse, southernkingfish_gJam_env_bc_forage$rmse_uncon, paired = FALSE)
wilcox.test(southernkingfish_gam_env_bc_forage$mean_rmse, southernkingfish_gJam_env_bc_forage$rmse_con, paired = FALSE) 
wilcox.test(southernkingfish_gJam_env_bc_forage$rmse_uncon, southernkingfish_gJam_env_bc_forage$rmse_con, paired = TRUE)
```

```{r}
### Black drum ###
#Env_bc 
wilcox.test(blackdrum_gam_env_bc$mean_rsq, blackdrum_gJam_env_bc$r2_uncon, paired = FALSE)
wilcox.test(blackdrum_gam_env_bc$mean_rsq, blackdrum_gJam_env_bc$r2_con, paired = FALSE) 
wilcox.test(blackdrum_gJam_env_bc$r2_uncon, blackdrum_gJam_env_bc$r2_con, paired = TRUE) 
wilcox.test(blackdrum_gam_env_bc$mean_rmse, blackdrum_gJam_env_bc$rmse_uncon, paired = FALSE)
wilcox.test(blackdrum_gam_env_bc$mean_rmse, blackdrum_gJam_env_bc$rmse_con, paired = FALSE) 
wilcox.test(blackdrum_gJam_env_bc$rmse_uncon, blackdrum_gJam_env_bc$rmse_con, paired = TRUE) 

#Env_forage
wilcox.test(blackdrum_gam_env_forage$mean_rsq, blackdrum_gJam_env_forage$r2_uncon, paired = FALSE)
wilcox.test(blackdrum_gam_env_forage$mean_rsq, blackdrum_gJam_env_forage$r2_con, paired = FALSE) 
wilcox.test(blackdrum_gJam_env_forage$r2_uncon, blackdrum_gJam_env_forage$r2_con, paired = TRUE) 
wilcox.test(blackdrum_gam_env_forage$mean_rmse, blackdrum_gJam_env_forage$rmse_uncon, paired = FALSE)
wilcox.test(blackdrum_gam_env_forage$mean_rmse, blackdrum_gJam_env_forage$rmse_con, paired = FALSE) 
wilcox.test(blackdrum_gJam_env_forage$rmse_uncon, blackdrum_gJam_env_forage$rmse_con, paired = TRUE) 

#Env_bc_forage
wilcox.test(blackdrum_gam_env_bc_forage$mean_rsq, blackdrum_gJam_env_bc_forage$r2_uncon, paired = FALSE)
wilcox.test(blackdrum_gam_env_bc_forage$mean_rsq, blackdrum_gJam_env_bc_forage$r2_con, paired = FALSE) 
wilcox.test(blackdrum_gJam_env_bc_forage$r2_uncon, blackdrum_gJam_env_bc_forage$r2_con, paired = TRUE) 
wilcox.test(blackdrum_gam_env_bc_forage$mean_rmse, blackdrum_gJam_env_bc_forage$rmse_uncon, paired = FALSE)
wilcox.test(blackdrum_gam_env_bc_forage$mean_rmse, blackdrum_gJam_env_bc_forage$rmse_con, paired = FALSE) 
wilcox.test(blackdrum_gJam_env_bc_forage$rmse_uncon, blackdrum_gJam_env_bc_forage$rmse_con, paired = TRUE) 
```

#### Summary metrics
```{r}
### Red drum ###
#Env + BC
mean(reddrum_gam_env_bc$mean_rsq)
sd(reddrum_gam_env_bc$mean_rsq)
mean(reddrum_gJam_env_bc$r2_uncon)
sd(reddrum_gJam_env_bc$r2_uncon)
mean(reddrum_gJam_env_bc$r2_con)
sd(reddrum_gJam_env_bc$r2_con)
mean(reddrum_gam_env_bc$mean_rmse)
sd(reddrum_gam_env_bc$mean_rmse)
mean(reddrum_gJam_env_bc$rmse_uncon)
sd(reddrum_gJam_env_bc$rmse_uncon)
mean(reddrum_gJam_env_bc$rmse_con)
sd(reddrum_gJam_env_bc$rmse_con)

#Env + forage
mean(reddrum_gam_env_forage$mean_rsq)
sd(reddrum_gam_env_forage$mean_rsq)
mean(reddrum_gJam_env_forage$r2_uncon)
sd(reddrum_gJam_env_forage$r2_uncon)
mean(reddrum_gJam_env_forage$r2_con)
sd(reddrum_gJam_env_forage$r2_con)
mean(reddrum_gam_env_forage$mean_rmse)
sd(reddrum_gam_env_forage$mean_rmse)
mean(reddrum_gJam_env_forage$rmse_uncon)
sd(reddrum_gJam_env_forage$rmse_uncon)
mean(reddrum_gJam_env_forage$rmse_con)
sd(reddrum_gJam_env_forage$rmse_con)

#Env + BC + forage
mean(reddrum_gam_env_bc_forage$mean_rsq)
sd(reddrum_gam_env_bc_forage$mean_rsq)
mean(reddrum_gJam_env_bc_forage$r2_uncon)
sd(reddrum_gJam_env_bc_forage$r2_uncon)
mean(reddrum_gJam_env_bc_forage$r2_con)
sd(reddrum_gJam_env_bc_forage$r2_con)
mean(reddrum_gam_env_bc_forage$mean_rmse)
sd(reddrum_gam_env_bc_forage$mean_rmse)
mean(reddrum_gJam_env_bc_forage$rmse_uncon)
sd(reddrum_gJam_env_bc_forage$rmse_uncon)
mean(reddrum_gJam_env_bc_forage$rmse_con)
sd(reddrum_gJam_env_bc_forage$rmse_con)
```

```{r}
### Southern kingfish ###
#Env + BC
mean(southernkingfish_gam_env_bc$mean_rsq)
sd(southernkingfish_gam_env_bc$mean_rsq)
mean(southernkingfish_gJam_env_bc$r2_uncon)
sd(southernkingfish_gJam_env_bc$r2_uncon)
mean(southernkingfish_gJam_env_bc$r2_con)
sd(southernkingfish_gJam_env_bc$r2_con)
mean(southernkingfish_gam_env_bc$mean_rmse)
sd(southernkingfish_gam_env_bc$mean_rmse)
mean(southernkingfish_gJam_env_bc$rmse_uncon)
sd(southernkingfish_gJam_env_bc$rmse_uncon)
mean(southernkingfish_gJam_env_bc$rmse_con)
sd(southernkingfish_gJam_env_bc$rmse_con)

#Env + forage
mean(southernkingfish_gam_env_forage$mean_rsq)
sd(southernkingfish_gam_env_forage$mean_rsq)
mean(southernkingfish_gJam_env_forage$r2_uncon)
sd(southernkingfish_gJam_env_forage$r2_uncon)
mean(southernkingfish_gJam_env_forage$r2_con)
sd(southernkingfish_gJam_env_forage$r2_con)
mean(southernkingfish_gam_env_forage$mean_rmse)
sd(southernkingfish_gam_env_forage$mean_rmse)
mean(southernkingfish_gJam_env_forage$rmse_uncon)
sd(southernkingfish_gJam_env_forage$rmse_uncon)
mean(southernkingfish_gJam_env_forage$rmse_con)
sd(southernkingfish_gJam_env_forage$rmse_con)

#Env + BC + forage 
mean(southernkingfish_gam_env_bc_forage$mean_rsq)
sd(southernkingfish_gam_env_bc_forage$mean_rsq)
mean(southernkingfish_gJam_env_bc_forage$r2_uncon)
sd(southernkingfish_gJam_env_bc_forage$r2_uncon)
mean(southernkingfish_gJam_env_bc_forage$r2_con)
sd(southernkingfish_gJam_env_bc_forage$r2_con)
mean(southernkingfish_gam_env_bc_forage$mean_rmse)
sd(southernkingfish_gam_env_bc_forage$mean_rmse)
mean(southernkingfish_gJam_env_bc_forage$rmse_uncon)
sd(southernkingfish_gJam_env_bc_forage$rmse_uncon)
mean(southernkingfish_gJam_env_bc_forage$rmse_con)
sd(southernkingfish_gJam_env_bc_forage$rmse_con)
```

```{r}
### Black drum ###
mean(blackdrum_gam_env_bc$mean_rsq)
sd(blackdrum_gam_env_bc$mean_rsq)
mean(blackdrum_gJam_env_bc$r2_uncon)
sd(blackdrum_gJam_env_bc$r2_uncon)
mean(blackdrum_gJam_env_bc$r2_con)
sd(blackdrum_gJam_env_bc$r2_con)
mean(blackdrum_gam_env_bc$mean_rmse)
sd(blackdrum_gam_env_bc$mean_rmse)
mean(blackdrum_gJam_env_bc$rmse_uncon)
sd(blackdrum_gJam_env_bc$rmse_uncon)
mean(blackdrum_gJam_env_bc$rmse_con)
sd(blackdrum_gJam_env_bc$rmse_con)

mean(blackdrum_gam_env_forage$mean_rsq)
sd(blackdrum_gam_env_forage$mean_rsq)
mean(blackdrum_gJam_env_forage$r2_uncon)
sd(blackdrum_gJam_env_forage$r2_uncon)
mean(blackdrum_gJam_env_forage$r2_con)
sd(blackdrum_gJam_env_forage$r2_con)
mean(blackdrum_gam_env_forage$mean_rmse)
sd(blackdrum_gam_env_forage$mean_rmse)
mean(blackdrum_gJam_env_forage$rmse_uncon)
sd(blackdrum_gJam_env_forage$rmse_uncon)
mean(blackdrum_gJam_env_forage$rmse_con)
sd(blackdrum_gJam_env_forage$rmse_con)

mean(blackdrum_gam_env_bc_forage$mean_rsq)
sd(blackdrum_gam_env_bc_forage$mean_rsq)
mean(blackdrum_gJam_env_bc_forage$r2_uncon)
sd(blackdrum_gJam_env_bc_forage$r2_uncon)
mean(blackdrum_gJam_env_bc_forage$r2_con)
sd(blackdrum_gJam_env_bc_forage$r2_con)
mean(blackdrum_gam_env_bc_forage$mean_rmse)
sd(blackdrum_gam_env_bc_forage$mean_rmse)
mean(blackdrum_gJam_env_bc_forage$rmse_uncon)
sd(blackdrum_gJam_env_bc_forage$rmse_uncon)
mean(blackdrum_gJam_env_bc_forage$rmse_con)
sd(blackdrum_gJam_env_bc_forage$rmse_con)
```
