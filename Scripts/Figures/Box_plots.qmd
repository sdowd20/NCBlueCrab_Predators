---
title: "Boxplots"
format: html
editor: visual
---

```{r}
prediction_boxplot <- read_excel("/users/sallydowd/Desktop/Ch1Data/Tables/prediction_new.xlsx") 
df <- prediction_boxplot

df$Model < - factor(df$Model, levels=c("Environment", "Blue crab", "Prey", "Environment + BC", "Environment + prey", "Environment + BC + prey"))
df_rd <- df %>% filter(Species %in% "Red drum")

ggplot(data= df_rd) + geom_boxplot(aes(lower= meanR2 - sdR2, upper= meanR2 + sdR2, middle= meanR2, ymin= meanR2- 3*sdR2, ymax= meanR2+3*sdR2, x= Model_type), stat= "identity") + facet_wrap(~factor(Model, c("Environment", "Blue crab", "Prey", "Environment + BC", "Environment + prey", "Environment + BC + prey"))) + ggtitle(expression(paste("Red drum, R"^"2"))) + scale_x_discrete(labels= c("GAM", "gJam traditional", "gJam conditional")) + standard_theme+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + xlab("Model type") + ylab(expression(paste("R"^"2")))
ggsave("/users/sallydowd/desktop/Ch1Data/Figures/R2_reddrum.png", width= 10, height= 7, dpi= 500)

df_sk <- df %>% filter(Species %in% "Southern kingfish")

ggplot(data= df_sk) + geom_boxplot(aes(lower= meanR2 - sdR2, upper= meanR2 + sdR2, middle= meanR2, ymin= meanR2- 3*sdR2, ymax= meanR2+3*sdR2, x= Model_type), stat= "identity") + facet_wrap(~factor(Model, c("Environment", "Blue crab", "Prey", "Environment + BC", "Environment + prey", "Environment + BC + prey"))) + ggtitle(expression(paste("Southern kingfish, R"^"2"))) + scale_x_discrete(labels= c("GAM", "gJam traditional", "gJam conditional")) + standard_theme+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + xlab("Model type") + ylab(expression(paste("R"^"2")))
ggsave("/users/sallydowd/desktop/Ch1Data/Figures/R2_sk.png", width= 10, height= 7, dpi= 500)

df_bd <- df %>% filter(Species %in% "Black drum")

ggplot(data= df_bd) + geom_boxplot(aes(lower= meanR2 - sdR2, upper= meanR2 + sdR2, middle= meanR2, ymin= meanR2- 3*sdR2, ymax= meanR2+3*sdR2, x= Model_type), stat= "identity") + facet_wrap(~factor(Model, c("Environment", "Blue crab", "Prey", "Environment + BC", "Environment + prey", "Environment + BC + prey"))) + ggtitle(expression(paste("Black drum, R"^"2"))) + scale_x_discrete(labels= c("GAM", "gJam traditional", "gJam conditional")) + standard_theme+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + xlab("Model type") + ylab(expression(paste("R"^"2")))
ggsave("/users/sallydowd/desktop/Ch1Data/Figures/R2_bd.png", width= 10, height= 7, dpi= 500)
```

```{r}
ggplot(data= df_rd) + geom_boxplot(aes(lower= meanRMSE - sdRMSE, upper= meanRMSE + sdRMSE, middle= meanRMSE, ymin= meanRMSE- 3*sdRMSE, ymax= meanRMSE+3*sdRMSE, x= Model_type), stat= "identity") + facet_wrap(~factor(Model, c("Environment", "Blue crab", "Prey", "Environment + BC", "Environment + prey", "Environment + BC + prey"))) + ggtitle("Red drum, RMSE") + scale_x_discrete(labels= c("GAM", "gJam traditional", "gJam conditional")) + standard_theme+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + xlab("Model type") + ylab("RMSE")
ggsave("/users/sallydowd/desktop/Ch1Data/Figures/RMSE_reddrum.png", width= 10, height= 7, dpi= 500)

ggplot(data= df_sk) + geom_boxplot(aes(lower= meanRMSE - sdRMSE, upper= meanRMSE + sdRMSE, middle= meanRMSE, ymin= meanRMSE- 3*sdRMSE, ymax= meanRMSE+3*sdRMSE, x= Model_type), stat= "identity") + facet_wrap(~factor(Model, c("Environment", "Blue crab", "Prey", "Environment + BC", "Environment + prey", "Environment + BC + prey"))) + ggtitle("Southern kingfish, RMSE") + scale_x_discrete(labels= c("GAM", "gJam traditional", "gJam conditional")) + standard_theme+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + xlab("Model type") + ylab("RMSE")
ggsave("/users/sallydowd/desktop/Ch1Data/Figures/RMSE_sk.png", width= 10, height= 7, dpi= 500)

ggplot(data= df_bd) + geom_boxplot(aes(lower= meanRMSE - sdRMSE, upper= meanRMSE + sdRMSE, middle= meanRMSE, ymin= meanRMSE- 3*sdRMSE, ymax= meanRMSE+3*sdRMSE, x= Model_type), stat= "identity") + facet_wrap(~factor(Model, c("Environment", "Blue crab", "Prey", "Environment + BC", "Environment + prey", "Environment + BC + prey"))) + ggtitle("Black drum, RMSE") + scale_x_discrete(labels= c("GAM", "gJam traditional", "gJam conditional")) + standard_theme+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + xlab("Model type") + ylab("RMSE")
ggsave("/users/sallydowd/desktop/Ch1Data/Figures/RMSE_bd.png", width= 10, height= 7, dpi= 500)
```

```{r}
# min(subset(df_rd, Model_type %in% "GAM")$meanR2) #prey
# max(subset(df_rd, Model_type %in% "GAM")$meanR2) #blue crab
# min(subset(df_rd, Model_type %in% "gJam_uncond")$meanR2, na.rm= TRUE) #Environment + BC
# max(subset(df_rd, Model_type %in% "gJam_uncond")$meanR2, na.rm= TRUE)
# min(subset(df_rd, Model_type %in% "gJam_cond")$meanR2, na.rm= TRUE)
# max(subset(df_rd, Model_type %in% "gJam_cond")$meanR2, na.rm= TRUE)
```

